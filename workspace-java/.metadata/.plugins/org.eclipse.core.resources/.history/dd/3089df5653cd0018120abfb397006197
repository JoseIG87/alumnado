package com.tecso.app.web;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RestController;

import com.tecso.app.model.Alumno;
import com.tecso.app.model.Persona;
import com.tecso.app.repository.AlumnoRepository;

@RestController
@RequestMapping("/alumno")
public class AlumnoController {
	
	private static final Logger LOGGER = LoggerFactory.getLogger(AlumnoController.class);
	
	@Autowired
	AlumnoRepository repository;
 
	@RequestMapping(value = "/savealumno", method = RequestMethod.POST)
	public void postCustomer(@RequestBody Persona persona) {
		
		Persona personaGuardar = new Persona();
		Alumno alumnoGuardar = new Alumno();
		
		personaGuardar.setTipoDoc(persona.getTipoDoc());
		personaGuardar.setDocumento(persona.getDocumento());
		personaGuardar.setNombre(persona.getNombre());
		personaGuardar.setApellido(persona.getApellido());
		personaGuardar.setFechaNac(persona.getFechaNac());
		personaGuardar.setDireccion(persona.getDireccion());
		
		repository.save(new Alumno(customer.getFirstName(), customer.getLastName()));
	}
 
	@RequestMapping("/findall")
	public Response findAll() {
 
		Iterable<Customer> customers = repository.findAll();
 
		return new Response("Done", customers);
	}
 
	@RequestMapping("/customer/{id}")
	public Response findCustomerById(@PathVariable("id") long id) {
 
		Customer customer = repository.findOne(id);
 
		return new Response("Done", customer);
	}
 
	@RequestMapping("/findbylastname")
	public Response findByLastName(@RequestParam("lastName") String lastName) {
 
		List<Customer> customers = repository.findByLastName(lastName);
 
		return new Response("Done", customers);
	}

}

